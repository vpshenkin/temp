import{f as available,u as unavailable,m as loading,x as flatMapL,H as asDynamicValue}from"./2252f97c.js";import"react";import{j as crash,s as splitAttributePath}from"./e81b9882.js";import{e as asMobxProperty}from"./0ad2390d.js";import"./3cf8690e.js";import"./0e7164f2.js";import"big.js";import"./11de92d0.js";import"./e4677d80.js";import{D as formatValue}from"./d1a3b52a.js";import{A as Access}from"./449717b5.js";import{M as MxObject1}from"./61ebc708.js";function templateToText(template,rootObject){var _a,_b;const parameters=null!==(_a=template.parameters)&&void 0!==_a?_a:{},formats=null!==(_b=template.formats)&&void 0!==_b?_b:{},elements=template.elements.map(element=>"string"==typeof element?available(element):function(rootObject,attributePath,format){if("unavailable"===rootObject.status)return unavailable();const{attribute:attribute,entityPath:entityPath}=splitAttributePath(attributePath),object=entityPath?flatMapL(rootObject,obj=>obj.getByPath$(entityPath)):rootObject;switch(object.status){case"available":const attr=object.value.get$(attribute);return attr.access===Access.None?available(""):available(function(entity,attribute,value,format){const metaObject=mx.meta.getEntity(entity),type=metaObject.getAttributeType(attribute);return"Enum"===type?void 0!==value?metaObject.getEnumCaption(attribute,value):"":formatValue(value,type,format)}(object.value.getEntity(),attribute,attr.value,format));case"unavailable":return available("");case"loading":return loading()}}(rootObject,parameters[element.toString()],formats[element.toString()]));return elements.some(e=>"unavailable"===e.status)?template.fallback?available(template.fallback):unavailable():elements.some(e=>"loading"===e.status)?loading():available(elements.map(e=>"available"===e.status?e.value:crash()).join(""))}const DynamicTextProperty=asMobxProperty((config,store)=>{const result=asDynamicValue(()=>{const mxObject1=MxObject1.fromState$(void 0!==config.scope?store.get$(config.scope,"object"):void 0);return templateToText(config.template,mxObject1)});return()=>result.get()});export{DynamicTextProperty};
